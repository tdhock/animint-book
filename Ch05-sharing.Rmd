---
title: Sharing
layout: default
output: bookdown::html_chapter
---

# Chapter 5, Sharing animints

```{r setup, echo=FALSE}
knitr::opts_chunk$set(fig.path="Ch05-figures/")
```

This chapter explains several methods for sharing your interactive
data visualizations on the web. After reading this chapter, you will
be able to share and publish animints

* on your personal computer.
* on [gist.github.com](https://gist.github.com/) and view them on
  [bl.ocks.org](http://bl.ocks.org/).
* in [R Markdown](http://rmarkdown.rstudio.com/) documents.
* using any web server, including
  [GitHub pages](https://pages.github.com/).

## Compile to a local directory {#animint2dir}

When experimenting with different interactive data visualization
designs, it is useful to preview them on your personal computer before
publishing on the web. This section discusses two methods for
compiling animints to a local directory.

So far in previous chapters we have only discussed one method for
creating interactive data visualizations. If `viz` is an animint (list
of ggplots and options with class animint), then printing it on the R
command line compiles that animint to a temporary
directory, using code like this,

```{r}
set.seed(1)
ten.points <- data.frame(x=0:9, y=rnorm(10))
animint(
  point=ggplot()+
    geom_point(aes(
      x, y), 
      data=ten.points)
)
```

The code above saves the animint to a new temporary directory. Rather
than saving each animint to a separate temporary directory, you can
specify an output directory via the `out.dir` argument to
`animint`. If you want to save the animint in the
`"Ch05-sharing-ten-points"` directory, use:

```{r}
animint(
  point=ggplot()+
    geom_point(aes(
      x, y), 
      data=ten.points),
  out.dir="Ch05-sharing-ten-points"
)
```

If the parent of `out.dir` does not exist, that is an error (you can
use `dir.create` to create the parent if necessary). If `out.dir` does
not exist, then it will be created. If `out.dir` does exist, then any
files in that directory will be overwritten. To view the data viz,
navigate to `Ch05-sharing-ten-points/index.html` in a web browser
(which should be done automatically / by default). If the web page is
blank, you may need to configure your browser to allow execution of
local JavaScript code, [as explained on our
FAQ](https://github.com/tdhock/animint2/wiki/FAQ#web-browser-on-local-indexhtml-file-is-blank).

Internally, R calls the `print.animint` S3 method, which calls
`animint2dir` to compile it to a new temporary directory on your
personal computer. Generally we advise to avoid calling `animint2dir`
directly, but it is useful if you want to avoid opening lots of
similar browser windows when repeatedly revising and rendering an
animint. You can prevent the default behavior of opening a browser
window via:

```{r eval=F}
viz <- animint(
  point=ggplot()+
    geom_point(aes(
      x, y), 
      data=ten.points))
animint2dir(
  viz, 
  out.dir="Ch05-sharing-ten-points-again", 
  open.browser=FALSE)
```

## Publish on GitHub Gist {#animint2gist}

Before attempting to use Gist as described in this section, please
note that since Jan 2023, bl.ocks.org is redirecting to gist, and is
not rendering, so it would be better to use another option like
[GitHub pages](https://pages.github.com/), or try to get gist
rendering working using [another
method](https://stackoverflow.com/questions/10717169).

This section explains how to publish an animint on the web via
[GitHub Gist](https://gist.github.com/). Gist was originally meant for
sharing code, but it also works for sharing animints.

To publish an animint on Gist, you need two things: (1) a GitHub
account, and (2) the `gistr` package. First, if you don't have a
GitHub account, you can
[sign up for free](https://github.com/join). Second, install the
`gistr` package:

```{r installgistr, eval=FALSE}
if(!require(gistr))install.packages("gistr")
```

Now you should be able to use `animint2gist(viz)` to publish `viz` as
a new gist. That command will post the files to a new gist, for
example https://gist.github.com/tdhock/2b029fe9abc8eb300f9f/. 

It will then open a new web browser window at the corresponding
bl.ocks.org URL, for example
http://bl.ocks.org/tdhock/raw/2b029fe9abc8eb300f9f/ In the past you
could use the bl.ocks.org URL to share your data visualization with
others. 

Beware that Gist imposes some limits. In March 2016 Gist imposed a
maximum of 300 files per gist, and a maximum of 1 megabyte per
file. The animint2gist function should stop with an error if your
animint exceeds either of these limits. If you run into this problem,
you may be able to use the [chunk_vars](Ch06-other.html#chunk_vars)
option to edit the number and size of files produced by
animint. Otherwise, try publishing your animint using one of the other
methods below.

## Publish in R Markdown {#Rmd}

To include an animint in an R Markdown document, use `animint(...)`
inside of an R code chunk. R will run the `knit_print.animint` S3
method, which compiles the animint to a local directory, named based
on the name of the R code chunk. For example a code chunk named
`viz-facets` will be saved in the directory `vizfacets`. Make sure to
put each animint in its own code chunk.

## Publish on a web server {#web-server}

Since animints are just directories with HTML, TSV, and JavaScript
files, you can publish them on any web server by simply copying the
directory to that server.

For example I executed the code in
https://github.com/tdhock/animint/blob/master/inst/examples/WorldBank-facets.R
to create the `WorldBank-facets` directory on my personal computer. I
copied that directory to my lab web server using `rsync -r
WorldBank-facets/ monsoon.hpc.nau.edu:genomic-ml/WorldBank-facets/` and so
I can view it on https://rcdata.nau.edu/genomic-ml/WorldBank-facets/

If you don't have access to a personal/lab web server, try using
[GitHub pages](https://pages.github.com/).

## Chapter summary and exercises {#exercises}

This chapter explained how to share animints on the web.

Exercises:

* Use GitHub pages to publish a visualization of a data set from your
  domain of expertise. Post a link to the data viz (and your source
  code) on the [Animint Gallery wiki
  page](https://github.com/tdhock/animint/wiki/Gallery).

Next, [Chapter 6](Ch06-other.html) explains the different options that
can be used to customize an animint.
